# Internal test workflow to validate ci.yml against the fixture project
name: Test CI Workflow

on:
  push:
    branches:
      - main
      - master
    paths:
      - '.github/workflows/ci.yml'
      - '.github/workflows/_test-ci.yml'
      - 'test-fixtures/kubebuilder-minimal/**'
  pull_request:
    branches:
      - main
      - master
    paths:
      - '.github/workflows/ci.yml'
      - '.github/workflows/_test-ci.yml'
      - 'test-fixtures/kubebuilder-minimal/**'
  workflow_dispatch:

jobs:
  test-ci:
    name: Test CI Workflow
    uses: ./.github/workflows/ci.yml
    with:
      working-directory: 'test-fixtures/kubebuilder-minimal'
      go-version-file: 'go.mod'
      push-image: true
      run-tests: true
      run-lint: true
    secrets: inherit
